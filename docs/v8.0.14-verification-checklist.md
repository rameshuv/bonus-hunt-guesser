# Bonus Hunt Guesser — v8.0.14 Verification Checklist

**Legend:** ✅ Pass · ❌ Fail · ⚠️ Partial/Needs Follow-up · ⬜ Not Tested

Each table lists the requirement, current status, the issue (when applicable), and the files/templates that must be updated to satisfy the customer contract. Paths are relative to the project root.

## 0) Plugin Header & Standards
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Header values match spec | ❌ | `Requires at least` is set to `6.3.5` instead of the agreed `6.3.0`. | `bonus-hunt-guesser.php` |
| Text domain loads correctly | ✅ | `load_plugin_textdomain( 'bonus-hunt-guesser', … )` executes during `plugins_loaded`. | — |
| PHPCS (WordPress standard) passes | ❌ | `vendor/bin/phpcs --standard=phpcs.xml` reports 900+ spacing/escaping/SQL issues across admin templates and helpers. | Multiple (`admin/views/*.php`, `includes/*.php`, `uninstall.php`) |

## 1) BHG Dashboard (Admin → Dashboard)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Each winner appears on its own row | ✅ | Winners loop renders one `<tr>` per record. | — |
| Winner username is bold | ✅ | Winner rows receive `.bhg-winner-row` (font-weight: 600). | — |
| “Latest Hunts” label & requested columns present | ✅ | Card heading is `Latest Hunts`, table outputs position/username/guess/difference plus hunt metadata. | — |

## 2) `bhg-bonus-hunts` (Add/Edit)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Tournament multiselect limited to active tournaments | ❌ | Query pulls every tournament without filtering by status/year. | `admin/views/bonus-hunts.php` |
| Results button lists guesses sorted by accuracy | ✅ | Ranking query orders by absolute diff ascending for closed hunts. | — |
| Winner count configurable (1–25) | ✅ | Form exposes `winners_count` input with min/max guards. | — |
| Edit view lists participants with removal + profile links | ✅ | Participant table includes guess, timestamp, delete form, and username link to profile. | — |
| Final Balance column shows “—” while hunt open | ✅ | Listing prints an em-dash when `final_balance` is null. | — |

## 3) `bhg-bonus-hunts-results`
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Row colours consistent (grey/white) | ✅ | Table uses `widefat striped` plus consistent hover styles. | — |
| Winners highlighted (green + bold) | ✅ | `.bhg-results-row--winner` adds green background and bold badges for top rows. | — |
| “Price” column present | ❌ | Results table only includes Position/User/Guess/Difference; no price heading or data. | `admin/views/bonus-hunts-results.php`, corresponding data sources |

## 4) `bhg-tournaments` (Connected Bonus Hunts)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Selector shows current-year hunts + already linked ones | ✅ | SQL limits hunts to the current year and merges in already-connected IDs. | — |

## 5) `bhg-users` (User Profile Affiliates)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Search users/email | ✅ | `BHG_Users_Table` inherits WP_List_Table search box tied to `WP_User_Query`. | — |
| Sortable table headers | ✅ | Columns register sortable keys (`username`, `display_name`, `email`). | — |
| Pagination (30 per page) | ✅ | Table enforces `$per_page = 30` with standard pagination controls. | — |

## 6) `bhg-affiliates` (Sync to User Profile)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Adding affiliate website creates per-user field | ❌ | Save handler only inserts into `bhg_affiliate_websites`; user meta fields/toggles are never generated. | `admin/class-bhg-admin.php`, `admin/views/users.php` |
| Removing affiliate deletes related user meta | ❌ | Delete handler drops the affiliate row but leaves any user meta untouched. | `admin/class-bhg-admin.php` |

## 7) `bhg-prizes` (Admin)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| “Prizes” menu with CRUD | ✅ | Admin view lists prizes with Add/Edit/Delete actions. | — |
| Fields: title, description, category, image | ✅ | Modal form captures all required fields; categories map to `cash_money`, `casino_money`, `coupons`, `merchandise`, `various`. | — |
| Images available in small/medium/big | ✅ | Form provides three media controls tied to small/medium/big meta. | — |
| Frontend CSS panel options (border, colour, spacing, background) | ✅ | Modal exposes CSS settings inputs for border, border colour, padding, margin, background. | — |
| Active yes/no toggle works | ✅ | Boolean `active` flag included in prize modal and listing. | — |

## 8) Prizes in Bonus Hunt (Admin)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Select 1+ prizes when creating/editing a hunt | ✅ | Hunt form multi-select lists available prizes and persists selection. | — |

## 9) Prizes — Frontend (Active Hunt)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Prizes render on active hunts | ✅ | Active hunt shortcode loads prize associations and displays them alongside hunt data. | — |
| Grid list or carousel view selectable | ✅ | `render_prize_section()` outputs grid or JS-enabled carousel with dots/arrows. | — |
| Carousel has dots and/or left/right arrows | ✅ | Carousel layout prints prev/next buttons and pagination dots when more than one prize. | — |

## 10) Prizes Shortcode
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| `[bhg_prizes]` supports `category`, `design`, `size`, `active` attrs | ✅ | Shortcode sanitizes each attribute, filters the query, and renders via `render_prize_section()`. | — |

## 11) User Shortcodes (Frontend, My Profile)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| `[my_bonushunts]`, `[my_tournaments]`, `[my_prizes]`, `[my_rankings]` exist | ❌ | Only `bhg_*` shortcodes are registered; the `my_*` aliases from the brief are absent. | `includes/class-bhg-shortcodes.php` |
| Admin toggles hide/show each block | ❌ | Settings screen offers no toggles for controlling individual profile blocks. | `admin/views/settings.php`, shortcode output handlers |

## 12) Global CSS/Colour Panel
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Controls for title/H2/H3/description/p/span typography & spacing | ❌ | Settings UI lacks global typography controls—only tournament defaults, currency, guess range, ads, and redirect fields exist. | `admin/views/settings.php`, related settings storage |

## 13) `bhg-shortcodes` (Admin)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Shortcodes menu listing all options | ❌ | Admin menu registers Dashboard → Settings, but no submenu for a shortcodes reference/help page. | `admin/class-bhg-admin.php`, new `admin/views/shortcodes/*.php` |

## 14) Notifications (`bhg-notifications`)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Winners/Tournament/Bonushunt tabs with enable, BCC, HTML | ✅ | Notifications page renders sections for winner/tournament/hunt emails with enable checkbox, subject/body fields, BCC textarea, and placeholder hints. | — |
| Delivery uses `wp_mail()` with headers + filters | ✅ | Notification helpers build sanitized headers (From/Bcc) and call `wp_mail()`; wrappers triggered when hunts/tournaments close. | — |

## 15) Tournaments — Prizes & Affiliate Fields
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Tournament admin/frontend show linked prizes | ❌ | Tournament form/view omits prize selection/output entirely. | `admin/views/tournaments.php`, tournament display templates |
| Affiliate website field + show/hide toggle | ❌ | Form has no affiliate website dropdown or visibility toggle despite database columns. | `admin/views/tournaments.php`, `includes/class-bhg-db.php` |

## 16) Tournament Ranking (Points System)
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Editable rank → points mapping & scope toggle | ❌ | No configuration screen or storage for points per place or scope selection. | Settings + tournament logic modules |
| Rankings aggregate winners with point totals | ❌ | Tournament controller lacks logic for computing standings from hunt winners. | `includes/` ranking helpers, admin/frontend output |
| Winners highlighted; Top 3 emphasised | ❌ | Without computed rankings, there is no highlight logic for tournament standings. | Same as above |

## 17) Data Integrity & Performance
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Schema migrations (tables/columns/indexes) up to date | ⚠️ | Tables are created with primary/index keys but no foreign key constraints; review whether relational integrity is required per brief. | `includes/class-bhg-db.php` |
| No significant N+1 queries; caching for heavy reads | ⚠️ | Dashboard fetches winners per hunt without caching and PHPCS flags numerous uncached direct queries; consider batching/caching. | `admin/views/dashboard.php`, `admin/views/bonus-hunts-results.php`, helper functions |
| Uninstall cleanup respects user data | ❌ | `uninstall.php` immediately drops all plugin tables/options without confirmation or retain-data toggle. | `uninstall.php`, settings |

## 18) Security & i18n
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Capability checks on admin pages | ⚠️ | Most handlers gate on `manage_options`, but PHPCS highlights additional AJAX/DB operations that need verification. | `admin/class-bhg-admin.php`, `includes/*.php` |
| Nonces on write actions | ⚠️ | Many forms include nonces, yet PHPCS reports missing nonce checks in some SQL routines and bulk actions. | Same as above |
| Escaping/sanitization on output/input | ⚠️ | Coding standard report surfaces unescaped output and unprepared SQL strings that must be normalised. | `admin/views/*.php`, `includes/*.php` |
| All strings translatable (`bonus-hunt-guesser`) | ⚠️ | Majority use `bhg_t()`, but hard-coded strings remain in helpers and templates per PHPCS notices. | `admin/views/*.php`, helpers |

## 19) Backward Compatibility
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Legacy data/settings migrate cleanly | ⚠️ | Migrations remove indexes/columns (e.g., `period`) without mapping legacy values; confirm upgrade helpers account for prior schema. | `includes/class-bhg-db.php`, upgrade scripts |
| Safe defaults for new options | ⚠️ | Several new settings (notifications, CSS) rely on runtime defaults but lack seeded option values for legacy installs. | Settings initialisation |

## 20) Release & Documentation
| Requirement | Status | Findings | Files to Update |
| --- | --- | --- | --- |
| Version bumped to 8.0.14 (header/constants) | ✅ | Header and `BHG_VERSION` constant both read `8.0.14`. | — |
| CHANGELOG updated with 8.0.14 notes | ❌ | Changelog stops at 8.0.11; no entry summarising 8.0.14 deliverables. | `CHANGELOG.md`, `CHANGELOG.txt` |
| Readme/Admin help updated for new features | ❌ | README/help docs lack coverage for notifications, new shortcodes, CSS controls, etc. | `README.md`, admin help views |

---

**Key Takeaways**
- Core hunt/prize administration and notification scaffolding exist, but tournament prize fields, affiliate sync, `my_*` shortcodes, and ranking logic remain incomplete.
- WordPress coding standards are not yet satisfied—address PHPCS failures to resolve escaping, nonce, and formatting issues before delivery.
- Documentation (changelog/readme) and uninstall safeguards still require attention to meet the customer’s release expectations.
